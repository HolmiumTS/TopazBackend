(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ff260344"],{4791:function(e,t,r){},a434:function(e,t,r){"use strict";var a=r("23e7"),n=r("23cb"),m=r("a691"),i=r("50c4"),o=r("7b0b"),s=r("65f0"),l=r("8418"),c=r("1dde"),b=r("ae40"),u=c("splice"),d=b("splice",{ACCESSORS:!0,0:0,1:2}),f=Math.max,p=Math.min,I=9007199254740991,h="Maximum allowed length exceeded";a({target:"Array",proto:!0,forced:!u||!d},{splice:function(e,t){var r,a,c,b,u,d,v=o(this),g=i(v.length),T=n(e,g),y=arguments.length;if(0===y?r=a=0:1===y?(r=0,a=g-T):(r=y-2,a=p(f(m(t),0),g-T)),g+r-a>I)throw TypeError(h);for(c=s(v,a),b=0;b<a;b++)u=T+b,u in v&&l(c,b,v[u]);if(c.length=a,r<a){for(b=T;b<g-a;b++)u=b+a,d=b+r,u in v?v[d]=v[u]:delete v[d];for(b=g;b>g-a+r;b--)delete v[b-1]}else if(r>a)for(b=g-a;b>T;b--)u=b+a-1,d=b+r-1,u in v?v[d]=v[u]:delete v[d];for(b=0;b<r;b++)v[b+T]=arguments[b+2];return v.length=g-a+r,c}})},c11a:function(e,t,r){"use strict";r.r(t);var a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-container",[r("el-main",{staticClass:"teamMember"},[r("h2",[e._v("团队成员")]),r("el-table",{staticStyle:{width:"1000px",margin:"auto auto","border-radius":"20px","box-shadow":"0 0 5px #b4bccc",padding:"20px 30px 30px 30px"},attrs:{height:"600",data:e.memberInfo,"default-sort":{prop:"memberType",order:"ascending"}}},[r("el-table-column",{attrs:{label:"用户","min-width":"40%"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-link",{attrs:{underline:!1,href:t.row.memberUrl}},[r("el-avatar",{attrs:{src:t.row.memberAvatar,alt:t.row.memberUsername}},[e._v(e._s(t.row.memberUsername))]),r("span",[e._v(e._s(t.row.memberUsername))])],1)]}}])}),r("el-table-column",{attrs:{label:"权限","min-width":"30%"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==t.row.memberType?r("div",[e._v("创建者")]):1==t.row.memberType?r("div",[e._v("管理员")]):2==t.row.memberType?r("div",[e._v("普通成员")]):e._e()]}}])}),r("el-table-column",{attrs:{label:"操作","min-width":"30%"},scopedSlots:e._u([{key:"default",fn:function(t){return[0==e.userTypeInTeam&&0!=t.row.memberType?r("el-button",{attrs:{plain:"",type:t.row.buttonType},nativeOn:{click:function(r){return r.preventDefault(),e.changeAdmin(t.$index,t.row)}}},[e._v(e._s(t.row.buttonText))]):e._e(),t.row.memberType<=1&&e.userId==t.row.memberId?r("el-button",{attrs:{type:"success",plain:"",round:""},nativeOn:{click:function(t){return t.preventDefault(),e.getAllApplication()}}},[e._v("审核申请")]):e._e(),e.userTypeInTeam<t.row.memberType?r("el-button",{attrs:{type:"danger",plain:""},nativeOn:{click:function(r){return r.preventDefault(),e.confirmKickOff(t.$index,t.row.memberId,t.row.memberUsername)}}},[e._v("踢出团队")]):e._e()]}}])})],1),r("el-dialog",{attrs:{title:"审核申请",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[r("el-table",{attrs:{data:e.applicationInfo}},[r("el-table-column",{attrs:{label:"用户",width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-link",{attrs:{underline:!1,href:t.row.url}},[r("el-avatar",{attrs:{src:t.row.avatar,alt:t.row.username}},[e._v(e._s(t.row.memberUsername))]),r("span",[e._v(e._s(t.row.username))])],1)]}}])}),r("el-table-column",{attrs:{label:"操作",width:"350"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("el-button",{attrs:{type:"primary",plain:""},nativeOn:{click:function(r){return r.preventDefault(),e.judgeApplication(t.$index,t.row.id,!0)}}},[e._v("通过")]),r("el-button",{attrs:{type:"warning",plain:""},nativeOn:{click:function(r){return r.preventDefault(),e.judgeApplication(t.$index,t.row.id,!1)}}},[e._v("拒绝")])]}}])})],1)],1)],1)],1)},n=[],m=(r("a434"),r("56d7")),i={data:function(){return{dialogTableVisible:!1,aboutTeam:{},userId:"",userTypeInTeam:2,applicationInfo:[],memberInfo:[]}},methods:{getAllApplication:function(){var e=this;this.dialogTableVisible=!0;var t={teamId:this.aboutTeam.teamId};Object(m["GetAllApplication"])(t).then((function(t){if(console.log(t.data),1==t.data.result){e.applicationInfo.splice(0,e.applicationInfo.length);for(var r=t.data.application.length,a=0;a<r;a++){var n=t.data.application[a];e.applicationInfo.push({id:n.id,url:Object(m["generateUserUrl"])(n.id),username:n.username,avatar:n.avatar})}}else e.$message.error({message:"获取申请失败，请稍后再试"})}))},judgeApplication:function(e,t,r){var a=this,n={teamId:this.aboutTeam.teamId,id:t,isAccept:1==r?"true":"false"};console.log("JudgeApplication.params: "+n),Object(m["JudgeApplication"])(n).then((function(r){1==r.data.result?(a.$message({type:"success",message:"true"===n.isAccept?"成功通过申请":"成功拒绝申请"}),"true"===n.isAccept&&Object(m["GetUserInfo"])({id:t}).then((function(e){a.memberInfo.push({memberId:t,memberUrl:Object(m["generateUserUrl"])(t),memberUsername:e.data.username,memberType:2,memberAvatar:e.data.avatar,buttonType:"primary",buttonText:"设为管理员"})})),a.applicationInfo.splice(e,1)):a.$message.error({message:"审核失败，请稍后再试"})}))},changeAdmin:function(e,t){1==t.memberType?this.cancelAdmin(e,t):this.setAdmin(e,t)},setAdmin:function(e,t){var r=this;console.log(t.memberId+" is set as Admin.");var a={teamId:this.aboutTeam.teamId,id:t.memberId};Object(m["SetAdmin"])(a).then((function(a){1==a.data.result?(r.$message({type:"success",message:"管理员设置成功"}),r.memberInfo.splice(e,1,{memberId:t.memberId,memberUrl:t.memberUrl,memberUsername:t.memberUsername,memberType:1,memberAvatar:t.memberAvatar,buttonType:"warning",buttonText:"取消管理员"})):r.$message.error({message:"管理员设置失败，请稍后再试"})}))},cancelAdmin:function(e,t){var r=this;console.log(t.memberId+" is cancelled.");var a={teamId:this.aboutTeam.teamId,id:t.memberId};Object(m["CancelAdmin"])(a).then((function(a){1==a.data.result?(r.$message({type:"success",message:"管理员取消成功"}),r.memberInfo.splice(e,1,{memberId:t.memberId,memberUrl:t.memberUrl,memberUsername:t.memberUsername,memberType:2,memberAvatar:t.memberAvatar,buttonType:"primary",buttonText:"设为管理员"})):r.$message.error({message:"管理员取消失败，请稍后再试"})}))},confirmKickOff:function(e,t,r){var a=this;this.$confirm("确定要将"+r+"踢出团队吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){a.kickOff(e,t)})).catch((function(){}))},kickOff:function(e,t){var r=this;console.log(t+" is kicked off.");var a={teamId:this.aboutTeam.teamId,id:t};Object(m["KickOff"])(a).then((function(t){1==t.data.result?(r.$message({type:"success",message:"踢出成员成功"}),r.memberInfo.splice(e,1)):r.$message.error({message:"踢出成员失败，请稍后再试"})}))}},mounted:function(){var e=this;this.userId=this.$store.state.userId,this.aboutTeam.teamId=this.$store.state.teamId;var t={teamId:this.aboutTeam.teamId};Object(m["GetTeamMember"])(t).then((function(t){if(1==t.data.result){for(var r=0;r<t.data.memberInfo.length;r++)e.memberInfo.push({}),e.memberInfo[r].memberId=t.data.memberInfo[r].memberId,e.memberInfo[r].memberUrl=Object(m["generateUserUrl"])(e.memberInfo[r].memberId),e.memberInfo[r].memberUsername=t.data.memberInfo[r].memberUsername,e.memberInfo[r].memberType=parseInt(t.data.memberInfo[r].memberType),e.memberInfo[r].memberAvatar=t.data.memberInfo[r].memberAvatar,e.memberInfo[r].memberId===e.$store.state.userId&&(e.userTypeInTeam=e.memberInfo[r].memberType);if(0==e.userTypeInTeam)for(var a=0;a<e.memberInfo.length;a++)1==e.memberInfo[a].memberType?(e.memberInfo[a].buttonText="取消管理员",e.memberInfo[a].buttonType="warning"):2==e.memberInfo[a].memberType&&(e.memberInfo[a].buttonText="设为管理员",e.memberInfo[a].buttonType="primary")}else e.$message.error({message:"无法获取团队成员"})}))}},o=i,s=(r("f168"),r("2877")),l=Object(s["a"])(o,a,n,!1,null,"9c5a66b0",null);t["default"]=l.exports},f168:function(e,t,r){"use strict";var a=r("4791"),n=r.n(a);n.a}}]);
//# sourceMappingURL=chunk-ff260344.a9340be1.js.map