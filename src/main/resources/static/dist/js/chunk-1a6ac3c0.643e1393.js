(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-1a6ac3c0"],{2975:function(e,t,o){"use strict";var a=o("d370"),n=o.n(a);n.a},cd8c:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return!0===this.showData?o("el-main",[!0===this.showData?o("el-row",[o("el-col",{attrs:{span:8,offset:6}},[o("el-input",{attrs:{id:"tt"},model:{value:e.doc.docName,callback:function(t){e.$set(e.doc,"docName",t)},expression:"doc.docName"}})],1),o("el-col",{attrs:{span:2,offset:2}},[o("el-button",{attrs:{type:"success",icon:"el-icon-check",circle:"",plain:""},on:{click:e.save}}),o("el-button",{attrs:{type:"warning",icon:"el-icon-close",circle:"",plain:""},on:{click:e.abort}})],1)],1):e._e(),o("p"),o("el-row",[o("el-col",{attrs:{span:12,offset:6}},[!0===this.showData?o("mavon-editor",{ref:"editor",staticStyle:{"min-height":"1000px"},attrs:{value:e.doc.content,toolbars:e.toolbars,placeholder:"在这里输入文档内容",defaultOpen:"edit",editable:!0,toolbarsBackground:"#E6E6E6",subfield:!1,ishljs:!0,scrollStyle:!0},on:{imgAdd:e.imgAdd,change:e.change}}):e._e()],1)],1)],1):e._e()},n=[],r=(o("b0c0"),o("d3b7"),o("25f0"),o("1105")),i=o("381a"),c=o.n(i),d=o("bc3a"),s=o.n(d),l=o("56d7"),u={data:function(){return{actionPath:"https://upload.qiniup.com",photoUrl:"http://qexiy12gt.hd-bkt.clouddn.com/",doc:{ownerName:"",content:"",count:"",createTime:"",updateTime:"",docName:""},showData:!1,toolbars:{bold:!0,italic:!0,header:!0,underline:!0,strikethrough:!0,mark:!0,superscript:!0,subscript:!0,quote:!0,ol:!0,ul:!0,link:!0,imagelink:!0,code:!0,table:!0,fullscreen:!0,readmodel:!0,htmlcode:!1,help:!1,undo:!0,redo:!0,trash:!1,save:!1,navigation:!0,alignleft:!0,aligncenter:!0,alignright:!0,subfield:!1,preview:!0}}},methods:{beforeUpload:function(e){var t="image/jpeg"===e.type||"image/jpg"===e.type||"image/png"===e.type,o=e.size/1024/1024<5;return t||this.$message.error("上传图片必须是 jpeg/jpg/png 格式！"),o||this.$message.error("上传图片大小不能超过 5MB！"),t&&o},imgAdd:function(e,t){var o=this;if(this.beforeUpload(t)){var a,n={},i="domaint",d="K96MCAU7eCnSWz4XUbxIBe9Q9PUm_gBHfacmsAEf",l="g0eagx-yjztmAo0iVi-Nj8QrsCRGrKhdGKIjpVr9",u=159984e4;n.scope=i,n.deadline=u,a=Object(r["a"])(d,l,n);var h=this.$refs.editor,p=new FormData;p.append("file",t),p.append("token",a),p.append("key",c()(16)),s.a.post(this.actionPath,p).then((function(t){h.$img2Url(e,o.photoUrl+t.data.key)}))}},save:function(){var e=this;console.log("[save]:"),console.log(this.doc.docName),console.log(this.doc.content),""!==this.doc.docName&&void 0!==this.doc.docName?this.doc.docName.length>16?this.$message.error("文档名长度不能超过16！"):Object(l["SaveFile"])({id:this.$store.state.userId,did:this.$route.query.docId,name:this.doc.docName,content:this.doc.content}).then((function(t){!1!==t.data.result?(e.$message("保存成功"),e.$router.push({path:"/docBrowse",query:{docId:e.$route.query.docId}})):e.$message.error("保存失败，请稍后再试")})):this.$message.error("文档名不能为空！")},abort:function(){Object(l["AbortFile"])({id:this.$store.state.userId,did:this.$route.query.docId}),this.$router.push({path:"/docBrowse",query:{docId:this.$route.query.docId}})},change:function(e,t){this.doc.content=e}},mounted:function(){var e=this;window.onbeforeunload=function(){Object(l["AbortFile"])({id:e.$store.state.userId.toString(),did:e.$route.query.docId.toString()})},Object(l["GetAuth"])({id:this.$store.state.userId.toString(),did:this.$route.query.docId.toString()}).then((function(t){!1!==t.data.edit?!0!==t.data.lock?(Object(l["EditFile"])({id:e.$store.state.userId.toString(),did:e.$route.query.docId.toString()}),Object(l["GetFile"])({id:e.$route.query.docId.toString()}).then((function(t){var o=t.data;!1!==o.result?(Object(l["GetUserInfo"])({id:o.owner.toString()}).then((function(t){e.doc.ownerName=t.data.username})),e.doc.createTime=o.createTime,e.doc.updateTime=o.updateTime,e.doc.content=o.content,e.doc.docName=o.name,e.showData=!0,console.log(e.doc.docName)):e.$message.error("请求文档失败！请稍后再试！")}))):e.$alert("文档正在被他人编辑中，请稍后再试","出错啦",{confirmButtonText:"确定",callback:function(t){e.$router.go(-1)}}):e.$alert("无文档编辑权限","出错啦",{confirmButtonText:"确定",callback:function(t){e.$router.go(-1)}})}))}},h=u,p=(o("2975"),o("2877")),m=Object(p["a"])(h,a,n,!1,null,null,null);t["default"]=m.exports},d370:function(e,t,o){}}]);
//# sourceMappingURL=chunk-1a6ac3c0.643e1393.js.map